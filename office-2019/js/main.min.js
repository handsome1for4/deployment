function saveTextAsFile(e){var c=document.getElementById(e).value;if(0!=c.length){var o=new Blob([c],{type:"text/plain"}),t=document.createElement("a");t.download="configuration.xml",t.innerHTML="Download File",null!=window.webkitURL?t.href=window.webkitURL.createObjectURL(o):(t.href=window.URL.createObjectURL(o),t.onclick=destroyClickedElement,t.style.display="none",document.body.appendChild(t)),t.click()}else alert("configuration.xml is invalid !")}function destroyClickedElement(e){document.body.removeChild(e.target)}var expanded=!1;function showCheckboxes(e){let c=document.getElementById(e);expanded?(c.style.display="none",expanded=!1):(c.style.display="block",expanded=!0)}!function(e){const c='    </Add>\n    <Display Level="Full" AcceptEULA="TRUE"/>\n    <Property Name="AUTOACTIVATE" Value="1"/>\n    <Property Name="FORCEAPPSHUTDOWN" Value="TRUE"/>\n    <Property Name="SharedComputerLicensing" Value="0"/>\n    <Property Name="PinIconsToTaskbar" Value="TRUE"/>\n    <Updates Enabled="TRUE" />\n    <Property Name="SCLCacheOverride" Value="0"/>\n    <RemoveMSI All="TRUE"/>\n';function o(c){return e.getElementById(c)}function t(c){return e.getElementsByClassName(c)}function l(c){return e.getElementsByName(c)}o("checkboxes-5").appendChild(t("clone")[0].cloneNode(!0)),o("checkboxes-3").appendChild(t("clone-2")[0].cloneNode(!0)),o("checkboxes-6").appendChild(t("clone-2")[0].cloneNode(!0)),o("checkboxes-7").appendChild(t("clone-2")[0].cloneNode(!0));var n=o("checkAccess"),a=o("checkExcel"),i=o("checkGroove"),r=o("checkLync"),d=o("checkOneDrive"),u=o("checkOneNote"),k=o("checkOutlook"),h=o("checkPowerPoint"),s=o("checkPublisher"),v=o("checkWord"),p=o("project"),y=o("visio"),P=o("projectstd"),f=o("visiostd"),b="",g="",m=$("#BackToTop");function A(e,c){o(e).addEventListener("change",function(){this.checked?o(c).setAttribute("disabled","disabled"):o(c).removeAttribute("disabled")})}function E(c,o){let t=e.querySelectorAll(c);for(var l=0;l<t.length;l++)t[l].checked&&(t[l].checked=!1),o&&t[l].setAttribute("disabled","disabled")}function x(c){let o=e.querySelectorAll(c);for(var t=0;t<o.length;t++)o[t].removeAttribute("disabled")}$(window).scroll(function(){$(this).scrollTop()>=200?m.show(10).animate("#BackToTop").addClass("active"):m.animate("#BackToTop").removeClass("active")}),m.click(function(e){e.preventDefault(),$("html,body").animate({scrollTop:0},800)}),o("generator").addEventListener("click",function(){if(n.checked||a.checked||i.checked||r.checked||d.checked||u.checked||k.checked||h.checked||s.checked||v.checked){o("config").value="";for(var t=l("edition"),g=l("platform"),m=l("channel"),A=o("key19Pro").value,E=o("key19Project").value,x=o("key19Visio").value,D=o("key19Std").value,S=o("key19Profesional").value,O=o("key19HB").value,I=o("key19HS").value,L=o("key19ProjectStd").value,V=o("key19VisioStd").value,R=o("key19Personal").value,w=!1,C=0;C<g.length;C++)for(var U=0;U<m.length;U++)for(var j=0;j<t.length;j++)if(g[C].checked&&m[U].checked&&t[j].checked){"ProPlus2019Volume"==t[j].value||"Standard2019Volume"==t[j].value?b+='<Configuration>\n    <Add OfficeClientEdition="'+g[C].value+'" Channel="PerpetualVL2019" AllowCdnFallback="TRUE" ForceUpgrade="TRUE">\n':b+='<Configuration>\n    <Add OfficeClientEdition="'+g[C].value+'" Channel="'+m[U].value+'" AllowCdnFallback="TRUE" ForceUpgrade="TRUE">\n';break}for(C=0;C<t.length;C++)if(t[C].checked){o("key19Pro").value.length>0&&("ProPlus2019Retail"==t[C].value||"ProPlus2019Volume"==t[C].value)?b+='        <Product ID="'+t[C].value+'" PIDKEY="'+A+'">\n':o("key19Std").value.length>0&&("Standard2019Retail"==t[C].value||"Standard2019Volume"==t[C].value)?b+='        <Product ID="'+t[C].value+'" PIDKEY="'+D+'">\n':o("key19Profesional").value.length>0&&"Professional2019Retail"==t[C].value?b+='        <Product ID="'+t[C].value+'" PIDKEY="'+S+'">\n':o("key19HB").value.length>0&&"HomeBusiness2019Retail"==t[C].value?b+='        <Product ID="'+t[C].value+'" PIDKEY="'+O+'">\n':o("key19HS").value.length>0&&"HomeStudent2019Retail"==t[C].value?b+='        <Product ID="'+t[C].value+'" PIDKEY="'+I+'">\n':o("key19Personal").value.length>0&&"Personal2019Retail"==t[C].value?b+='        <Product ID="'+t[C].value+'" PIDKEY="'+R+'">\n':b+='        <Product ID="'+t[C].value+'">\n';break}var T=e.querySelectorAll("#checkboxes-1 input[type=checkbox]");for(C=0;C<T.length;C++)T[C].checked&&(b+='            <Language ID="'+T[C].value+'"/>\n',w=!0);function N(c,t,l,n,a){let i=!1;o(c).value.length>0?b+='        <Product ID="'+t+"2019"+l+'" PIDKEY="'+n+'">\n':b+='        <Product ID="'+t+"2019"+l+'">\n';for(var r=e.querySelectorAll("#"+a+" input[type=checkbox]"),d=0;d<r.length;d++)r[d].checked&&(b+='            <Language ID="'+r[d].value+'"/>\n',i=!0);i||(b+='            <Language ID="MatchOS"/>\n'),b+="        </Product>\n"}if(w||(b+='            <Language ID="MatchOS"/>\n'),n.checked||(b+='            <ExcludeApp ID="Access"/>\n'),a.checked||(b+='            <ExcludeApp ID="Excel"/>\n'),i.checked||(b+='            <ExcludeApp ID="Groove"/>\n'),r.checked||(b+='            <ExcludeApp ID="Lync"/>\n'),d.checked||(b+='            <ExcludeApp ID="OneDrive"/>\n'),u.checked||(b+='            <ExcludeApp ID="OneNote"/>\n'),k.checked||(b+='            <ExcludeApp ID="Outlook"/>\n'),h.checked||(b+='            <ExcludeApp ID="PowerPoint"/>\n'),s.checked||(b+='            <ExcludeApp ID="Publisher"/>\n'),v.checked||(b+='            <ExcludeApp ID="Word"/>\n'),b+="        </Product>\n",p.checked)for(C=0;C<t.length;C++)t[C].checked&&("ProPlus2019Volume"==t[C].value||"Standard2019Volume"==t[C].value?N("key19Project","ProjectPro","Volume",E,"checkboxes-2"):N("key19Project","ProjectPro","Retail",E,"checkboxes-2"));if(y.checked)for(C=0;C<t.length;C++)t[C].checked&&("ProPlus2019Volume"==t[C].value||"Standard2019Volume"==t[C].value?N("key19Visio","VisioPro","Volume",x,"checkboxes-3"):N("key19Visio","VisioPro","Retail",x,"checkboxes-3"));if(P.checked)for(C=0;C<t.length;C++)t[C].checked&&("ProPlus2019Volume"==t[C].value||"Standard2019Volume"==t[C].value?N("key19ProjectStd","ProjectStd","Volume",L,"checkboxes-6"):N("key19ProjectStd","ProjectStd","Retail",L,"checkboxes-6"));if(f.checked)for(C=0;C<t.length;C++)t[C].checked&&("ProPlus2019Volume"==t[C].value||"Standard2019Volume"==t[C].value?N("key19VisioStd","VisioStd","Volume",V,"checkboxes-7"):N("key19VisioStd","VisioStd","Retail",V,"checkboxes-7"));b+=c,b+="</Configuration>",o("config").value=b,b=""}else alert("Please choose minimize 1 app to install")}),o("generator-2").addEventListener("click",function(){for(var t=!1,n=e.querySelectorAll("#checkboxes-4 input[type=checkbox]"),a=0;a<n.length;a++)n[a].checked&&(t=!0);if(t){o("config-2").value="";for(var i=l("platform-2"),r=l("channel-2"),d=l("lic"),u=0;u<d.length;u++)for(a=0;a<i.length;a++)for(var k=0;k<r.length;k++)if(d[u].checked&&i[a].checked&&r[k].checked){"retail"==d[u].value?g+='<Configuration>\n    <Add OfficeClientEdition="'+i[a].value+'" Channel="'+r[k].value+'" AllowCdnFallback="TRUE" ForceUpgrade="TRUE">\n':g+='<Configuration>\n    <Add OfficeClientEdition="'+i[a].value+'" Channel="PerpetualVL2019" AllowCdnFallback="TRUE" ForceUpgrade="TRUE">\n';break}function h(c,t){if(o(c).checked){for(var l=0;l<d.length;l++)d[l].checked&&("retail"==d[l].value?o(t).value.length>0?g+='        <Product ID="'+o(c).value+'Retail" PIDKEY="'+o(t).value+'">\n':g+='        <Product ID="'+o(c).value+'Retail">\n':o(t).value.length>0?g+='        <Product ID="'+o(c).value+'Volume" PIDKEY="'+o(t).value+'">\n':g+='        <Product ID="'+o(c).value+'Volume">\n');let i=!1;for(var n=e.querySelectorAll("#checkboxes-5 input[type=checkbox]"),a=0;a<n.length;a++)n[a].checked&&(g+='            <Language ID="'+n[a].value+'"/>\n',i=!0);i||(g+='            <Language ID="MatchOS"/>\n'),g+="        </Product>\n"}}h("19Word","key19Word"),h("19Excel","key19Excel"),h("19Access","key19Access"),h("19Outlook","key19Outlook"),h("19OneNote","key19OneNote"),h("19PowerPoint","key19PowerPoint"),h("19Publisher","key19Publisher"),h("19ProjectPro","key19ProjectPro"),h("19VisioPro","key19VisioPro"),h("19ProjectStd","_key19ProjectStd"),h("19VisioStd","_key19VisioStd"),g+=c,g+="</Configuration>",o("config-2").value=g,g=""}else alert("Please choose minimize 1 app to install")}),A("19ProjectPro","19ProjectStd"),A("19VisioPro","19VisioStd"),A("19ProjectStd","19ProjectPro"),A("19VisioStd","19VisioPro"),A("project","projectstd"),A("projectstd","project"),A("visio","visiostd"),A("visiostd","visio");for(var D=e.querySelectorAll("input[type=radio][name=edition]"),S=0;S<D.length;S++)D[S].addEventListener("change",function(){switch(this.value){case"O365HomePremRetail":E("#checkGroove,#checkLync,#checkOneDrive,#checkOneNote",!0),x("#checkAccess,#checkOutlook,#checkPublisher");break;case"O365BusinessRetail":E("#checkGroove,#checkLync,#checkOneDrive,#checkPublisher",!0),x("#checkAccess,#checkOutlook,#checkOneNote");break;case"Professional2019Retail":E("#checkGroove,#checkLync",!0),x("#checkAccess,#checkOneDrive,#checkOutlook,#checkPublisher,#checkOneNote");break;case"Personal2019Retail":E("#checkGroove,#checkLync,#checkOneDrive",!0),x("#checkAccess,#checkOutlook,#checkPublisher,#checkOneNote");break;case"Standard2019Retail":case"Standard2019Volume":E("#checkAccess,#checkGroove,#checkLync",!0),x("#checkOneDrive,#checkOutlook,#checkPublisher,#checkOneNote");break;case"HomeBusiness2019Retail":E("#checkAccess,#checkGroove,#checkLync,#checkOneDrive,#checkPublisher",!0),x("#checkOutlook,#checkOneNote");break;case"HomeStudent2019Retail":E("#checkAccess,#checkGroove,#checkLync,#checkOneDrive,#checkOutlook,#checkPublisher",!0),x("#checkOneNote");break;default:{let o=e.querySelectorAll("#checkAccess,#checkGroove,#checkLync");for(var c=0;c<o.length;c++)o[c].removeAttribute("disabled")}}});function O(c){e.getElementById(c).value.length>0?(e.getElementById(c).select(),e.execCommand("copy")):alert("Nothing to copy !")}function I(c,o){let t=new Blob([o],{type:"text/plain"}),l=e.createElement("a");l.download=c,l.innerHTML="Download File",null!=window.webkitURL?l.href=window.webkitURL.createObjectURL(t):(l.href=window.URL.createObjectURL(t),l.onclick=function(e){document.body.removeChild(e.target)},l.style.display="none",document.body.appendChild(l)),l.click()}o("reset").addEventListener("click",function(){o("config").value="";for(var c=e.querySelectorAll("#key-group input[type=text]"),t=0;t<c.length;t++)c[t].value="";o("rad1").checked=!0,o("rad2").checked=!0,o("rad3").checked=!0,o("checkboxes-1").style.display="none",o("checkboxes-2").style.display="none",o("checkboxes-3").style.display="none",o("checkboxes-6").style.display="none",o("checkboxes-7").style.display="none";for(var l=e.querySelectorAll("#checkboxes-1 input[type=checkbox],#checkboxes-2 input[type=checkbox],#checkboxes-3 input[type=checkbox],#project,#visio,#projectstd,#visiostd,.checkAllApps"),n=0;n<l.length;n++)l[n].removeAttribute("disabled"),l[n].checked=!1}),o("reset-2").addEventListener("click",function(){o("config-2").value="",o("rad21").checked=!0,o("rad31").checked=!0;for(var c=e.querySelectorAll("#checkboxes-4 input[type=checkbox],#checkboxes-5 input[type=checkbox]"),t=0;t<c.length;t++)c[t].removeAttribute("disabled"),c[t].checked=!1;o("checkboxes-5").style.display="none";for(var l=e.querySelectorAll("#key-group-2 input[type=text]"),n=0;n<l.length;n++)l[n].value=""}),o("checkAllApps").addEventListener("click",function(){for(var e=t("checkAllApps"),c=0;c<e.length;c++)"disabled"!=e[c].getAttribute("disabled")&&(e[c].checked=!0)}),o("uncheckAllApps").addEventListener("click",function(){!function(e,c){let o=t(e);for(var l=0;l<o.length;l++)o[l].checked=c}("checkAllApps",!1)}),o("copy-config").addEventListener("click",function(){O("config")}),o("copy-config-2").addEventListener("click",function(){O("config-2")}),o("d1").addEventListener("click",function(){$.get("bat/download-and-install.txt",function(e){I("Install.bat",e)})}),o("d2").addEventListener("click",function(){$.get("bat/download.txt",function(e){I("Download.bat",e)})})}(document);